{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-linking","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":40,"index":119}}],"key":"UOn5wJuCXvTT9EneNUmI6H0GQgM=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":120},"end":{"line":3,"column":47,"index":167}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":168},"end":{"line":4,"column":69,"index":237}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":279},"end":{"line":6,"column":26,"index":305}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"../services/notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":306},"end":{"line":12,"column":35,"index":491}}],"key":"PilFUkBfYpg1cVGLNRiWDw/oULQ=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}),t.default=e,t}function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return d}}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return h}});var o=r(_d[0]),n=(e(r(_d[1])),e(r(_d[2])),t(r(_d[3])));r(_d[4]);var s=t(r(_d[5])),c=(r(_d[6]),r(_d[7]));const u=process.env.EXPO_PUBLIC_BACKEND_URL||'',l=(0,o.createContext)({user:null,loading:!0,login:async()=>{},logout:async()=>{},refreshUser:async()=>{}}),d=()=>(0,o.useContext)(l),h=({children:e})=>{const[t,d]=(0,o.useState)(null),[h,f]=(0,o.useState)(!0);(0,o.useEffect)(()=>{_()},[]),(0,o.useEffect)(()=>{0},[t]),(0,o.useEffect)(()=>{if(!t)return;let e=!0,o=null,c=null;const l=()=>{e&&n.default.getItem('session_token').then(t=>{t&&e&&s.default.post(`${u}/api/auth/heartbeat`,{},{headers:{Authorization:`Bearer ${t}`},timeout:5e3}).catch(()=>{})}).catch(()=>{})};return o=setTimeout(l,5e3),c=setInterval(l,12e4),()=>{e=!1,o&&clearTimeout(o),c&&clearInterval(c)}},[t]);const _=async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});d(t.data)}}catch(e){console.error('Session check error:',e),await n.default.removeItem('session_token')}finally{f(!1)}},w=async e=>{try{let t=null;if(e.includes('#session_id=')?t=e.split('#session_id=')[1].split('&')[0]:e.includes('?session_id=')&&(t=e.split('?session_id=')[1].split('&')[0]),!t)throw new Error('No session_id found in redirect URL');const o=await s.default.post(`${u}/api/auth/session`,{},{headers:{'X-Session-ID':t}}),{session_token:c,...l}=o.data;await n.default.setItem('session_token',c);const h=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${c}`}});d(h.data)}catch(e){throw console.error('Auth redirect error:',e),e}};return(0,o.useEffect)(()=>{(async()=>{window.location.hash.includes('session_id=')&&(await w(window.location.href),window.history.replaceState({},document.title,window.location.pathname))})()},[]),(0,c.jsx)(l.Provider,{value:{user:t,loading:h,login:async()=>{try{f(!0);const e=`${u}/`,t=`https://auth.emergentagent.com/?redirect=${encodeURIComponent(e)}`;window.location.href=t}catch(e){console.error('Login error:',e),f(!1)}},logout:async()=>{try{const e=await n.default.getItem('session_token');e&&s.default.post(`${u}/api/auth/logout`,{},{headers:{Authorization:`Bearer ${e}`}}).catch(()=>{})}catch(e){console.error('Logout error:',e)}n.default.removeItem('session_token').catch(()=>{}),d(null)},refreshUser:async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me?_t=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`,'Cache-Control':'no-cache',Pragma:'no-cache'}});d(t.data)}}catch(e){console.error('Refresh user error:',e)}}},children:e})}});","lineCount":1,"map":[[1,378,45,0,"Object"],[1,385,45,0,"defineProperty"],[1,400,45,0,"_e"],[1,403,45,0],[1,414,45,0,"enumerable"],[1,426,45,0],[1,428,45,0,"get"],[1,432,45,0],[1,450,45,0,"useAuth"],[1,451,45,0],[1,455,47,0,"Object"],[1,462,47,0,"defineProperty"],[1,477,47,0,"_e"],[1,480,47,0],[1,496,47,0,"enumerable"],[1,508,47,0],[1,510,47,0,"get"],[1,514,47,0],[1,532,47,0,"AuthProvider"],[1,533,47,0],[1,537,1,0],[1,541,1,0,"_react"],[1,543,1,0,"r"],[1,545,1,0,"_d"],[1,548,1,0],[1,552,4,0,"AsyncStorage"],[1,555,2,0,"_interopNamespace"],[1,557,2,0,"r"],[1,559,2,0,"_d"],[1,562,2,0],[1,567,3,0,"_interopNamespace"],[1,569,3,0,"r"],[1,571,3,0,"_d"],[1,574,3,0],[1,579,4,0,"_interopDefault"],[1,581,4,0,"r"],[1,583,4,0,"_d"],[1,586,4,0],[1,592,4,69,"r"],[1,594,4,69,"_d"],[1,597,4,69],[1,601,6,0],[1,605,6,0,"axios"],[1,607,6,0,"_interopDefault"],[1,609,6,0,"r"],[1,611,6,0,"_d"],[1,614,6,0],[1,619,12,35,"_reactJsxRuntime"],[1,622,7,0,"r"],[1,624,7,0,"_d"],[1,627,7,0],[1,631,12,35,"r"],[1,633,12,35,"_d"],[1,636,12,35],[1,641,14,0],[1,647,14,6,"BACKEND_URL"],[1,649,14,20,"process"],[1,657,14,28,"env"],[1,661,14,32,"EXPO_PUBLIC_BACKEND_URL"],[1,686,14,59],[1,689,37,6,"AuthContext"],[1,692,37,20],[1,694,37,20,"createContext"],[1,696,37,33,"createContext"],[1,711,37,51],[1,712,38,2,"user"],[1,717,38,8],[1,722,39,2,"loading"],[1,731,39,11],[1,733,40,2,"login"],[1,739,40,9,"async"],[1,751,41,2,"logout"],[1,758,41,10,"async"],[1,770,42,2,"refreshUser"],[1,782,42,15,"async"],[1,796,45,13,"useAuth"],[1,798,45,23,"useAuth"],[1,803,45,29],[1,805,45,29,"useContext"],[1,807,45,39,"useContext"],[1,819,45,40,"AuthContext"],[1,822,47,13,"AuthProvider"],[1,824,47,69,"AuthProvider"],[1,826,47,72,"children"],[1,841,48,2],[1,847,48,9,"user"],[1,849,48,15,"setUser"],[1,853,48,26],[1,855,48,26,"useState"],[1,857,48,34,"useState"],[1,867,48,48],[1,874,49,9,"loading"],[1,876,49,18,"setLoading"],[1,880,49,32],[1,882,49,32,"useState"],[1,884,49,40,"useState"],[1,895,49,41],[1,899,52,2],[1,901,52,2,"useEffect"],[1,903,52,11,"useEffect"],[1,914,52,12],[1,919,53,4,"checkExistingSession"],[1,924,54,5],[1,929,57,2],[1,931,57,2,"useEffect"],[1,933,57,11,"useEffect"],[1,944,57,12],[1,949,58,8,"user"],[1,952,62,5],[1,953,62,6,"user"],[1,958,65,2],[1,960,65,2,"useEffect"],[1,962,65,11,"useEffect"],[1,973,65,12],[1,978,66,4],[1,982,66,9,"user"],[1,984,66,15],[1,991,68,4],[1,995,68,8,"isActive"],[1,998,68,19],[1,1000,69,8,"timeoutId"],[1,1002,69,43],[1,1007,70,8,"intervalId"],[1,1009,70,44],[1,1014,72,4],[1,1020,72,10,"sendHeartbeat"],[1,1022,72,26,"sendHeartbeat"],[1,1027,73,11,"isActive"],[1,1030,75,6,"AsyncStorage"],[1,1032,75,18,"default"],[1,1040,75,19,"getItem"],[1,1048,75,27],[1,1065,75,44,"then"],[1,1070,75,49,"token"],[1,1074,76,12,"token"],[1,1077,76,21,"isActive"],[1,1080,77,10,"axios"],[1,1082,77,15,"default"],[1,1090,77,16,"post"],[1,1095,77,21],[1,1098,77,24,"BACKEND_URL"],[1,1121,77,58],[1,1122,77,59],[1,1124,77,62],[1,1125,78,12,"headers"],[1,1133,78,21],[1,1134,78,23,"Authorization"],[1,1148,78,38],[1,1158,78,48,"token"],[1,1163,79,12,"timeout"],[1,1171,79,21],[1,1177,80,13,"catch"],[1,1183,80,19],[1,1193,82,9,"catch"],[1,1199,82,15],[1,1208,91,4],[1,1215,86,4,"timeoutId"],[1,1217,86,16,"setTimeout"],[1,1228,86,27,"sendHeartbeat"],[1,1230,86,42],[1,1235,89,4,"intervalId"],[1,1237,89,17,"setInterval"],[1,1249,89,29,"sendHeartbeat"],[1,1251,89,44],[1,1257,91,11],[1,1262,92,6,"isActive"],[1,1265,92,17],[1,1267,93,10,"timeoutId"],[1,1270,93,21,"clearTimeout"],[1,1283,93,34,"timeoutId"],[1,1286,94,10,"intervalId"],[1,1289,94,22,"clearInterval"],[1,1303,94,36,"intervalId"],[1,1308,96,5],[1,1309,96,6,"user"],[1,1313,98,2],[1,1319,139,8,"checkExistingSession"],[1,1321,139,31,"async"],[1,1331,140,4],[1,1335,141,6],[1,1341,141,12,"token"],[1,1349,141,26,"AsyncStorage"],[1,1351,141,38,"default"],[1,1359,141,39,"getItem"],[1,1367,141,47],[1,1384,142,6],[1,1387,142,10,"token"],[1,1389,142,17],[1,1390,144,8],[1,1396,144,14,"response"],[1,1404,144,31,"axios"],[1,1406,144,36,"default"],[1,1414,144,37,"get"],[1,1418,144,41],[1,1421,144,44,"BACKEND_URL"],[1,1437,144,71],[1,1438,145,10,"headers"],[1,1446,145,19],[1,1447,145,21,"Authorization"],[1,1461,145,36],[1,1471,145,46,"token"],[1,1478,147,8,"setUser"],[1,1480,147,16,"response"],[1,1482,147,25,"data"],[1,1487,148,6],[1,1488,149,4],[1,1489,149,6],[1,1495,149,13,"error"],[1,1498,150,6,"console"],[1,1506,150,14,"error"],[1,1512,150,20],[1,1535,150,44,"error"],[1,1544,151,12,"AsyncStorage"],[1,1546,151,24,"default"],[1,1554,151,25,"removeItem"],[1,1565,151,36],[1,1581,152,4],[1,1582,152,5],[1,1590,153,6,"setLoading"],[1,1593,153,17],[1,1595,154,4],[1,1598,184,8,"handleAuthRedirect"],[1,1600,184,29,"async"],[1,1610,185,4],[1,1614,187,6],[1,1618,187,10,"sessionId"],[1,1620,187,22],[1,1625,198,6],[1,1628,190,10,"url"],[1,1630,190,14,"includes"],[1,1639,190,23],[1,1655,191,8,"sessionId"],[1,1657,191,20,"url"],[1,1659,191,24,"split"],[1,1665,191,30],[1,1681,191,46],[1,1684,191,49,"split"],[1,1690,191,55],[1,1695,191,60],[1,1698,194,15,"url"],[1,1700,194,19,"includes"],[1,1709,194,28],[1,1727,195,8,"sessionId"],[1,1729,195,20,"url"],[1,1731,195,24,"split"],[1,1737,195,30],[1,1753,195,46],[1,1756,195,49,"split"],[1,1762,195,55],[1,1767,195,60],[1,1772,198,11,"sessionId"],[1,1774,199,8],[1,1780,199,14],[1,1784,199,18,"Error"],[1,1790,199,24],[1,1829,203,6],[1,1835,203,12,"response"],[1,1843,203,29,"axios"],[1,1845,203,34,"default"],[1,1853,203,35,"post"],[1,1858,204,8],[1,1861,204,11,"BACKEND_URL"],[1,1882,205,8],[1,1883,205,9],[1,1885,206,8],[1,1886,207,10,"headers"],[1,1894,207,19],[1,1895,207,21],[1,1910,207,37,"sessionId"],[1,1916,211,12,"session_token"],[1,1930,211,14,"session_token"],[1,1935,211,32,"userData"],[1,1938,211,45,"response"],[1,1940,211,54,"data"],[1,1951,214,12,"AsyncStorage"],[1,1953,214,24,"default"],[1,1961,214,25,"setItem"],[1,1969,214,33],[1,1985,214,50,"session_token"],[1,1988,217,6],[1,1994,217,12,"userResponse"],[1,2002,217,33,"axios"],[1,2004,217,38,"default"],[1,2012,217,39,"get"],[1,2016,217,43],[1,2019,217,46,"BACKEND_URL"],[1,2035,217,73],[1,2036,218,8,"headers"],[1,2044,218,17],[1,2045,218,19,"Authorization"],[1,2059,218,34],[1,2069,218,44,"session_token"],[1,2076,221,6,"setUser"],[1,2078,221,14,"userResponse"],[1,2080,221,27,"data"],[1,2085,222,4],[1,2086,222,6],[1,2092,222,13,"error"],[1,2095,224,6],[1,2101,223,6,"console"],[1,2109,223,14,"error"],[1,2115,223,20],[1,2138,223,44,"error"],[1,2141,224,12,"error"],[1,2142,225,4],[1,2145,286,2],[1,2152,271,2],[1,2154,271,2,"useEffect"],[1,2156,271,11,"useEffect"],[1,2167,271,12],[1,2172,273,28,"async"],[1,2183,274,21,"window"],[1,2190,274,28,"location"],[1,2199,274,37,"hash"],[1,2204,275,17,"includes"],[1,2213,275,26],[1,2236,276,16,"handleAuthRedirect"],[1,2238,276,35,"window"],[1,2245,276,42,"location"],[1,2254,276,51,"href"],[1,2260,278,10,"window"],[1,2267,278,17,"history"],[1,2275,278,25,"replaceState"],[1,2288,278,38],[1,2289,278,39],[1,2291,278,42,"document"],[1,2300,278,51,"title"],[1,2306,278,58,"window"],[1,2313,278,65,"location"],[1,2322,278,74,"pathname"],[1,2334,282,6,"handleWebAuth"],[1,2338,284,5],[1,2343,287,4],[1,2345,287,4,"_reactJsxRuntime"],[1,2347,287,4,"jsx"],[1,2352,287,5,"AuthContext"],[1,2354,287,17,"Provider"],[1,2363,287,25],[1,2364,287,26,"value"],[1,2370,287,33],[1,2371,287,35,"user"],[1,2378,287,41,"loading"],[1,2388,287,50,"login"],[1,2394,157,16,"async"],[1,2404,158,4],[1,2408,159,6,"setLoading"],[1,2411,159,17],[1,2414,161,6],[1,2420,161,12,"redirectUrl"],[1,2422,162,74],[1,2425,162,77,"BACKEND_URL"],[1,2430,165,12,"authUrl"],[1,2432,165,22],[1,2476,165,66,"encodeURIComponent"],[1,2495,165,85,"redirectUrl"],[1,2500,169,8,"window"],[1,2507,169,15,"location"],[1,2516,169,24,"href"],[1,2521,169,31,"authUrl"],[1,2522,178,4],[1,2523,178,6],[1,2529,178,13,"error"],[1,2532,179,6,"console"],[1,2540,179,14,"error"],[1,2546,179,20],[1,2561,179,36,"error"],[1,2564,180,6,"setLoading"],[1,2567,180,17],[1,2569,181,4],[1,2572,287,57,"logout"],[1,2579,228,17,"async"],[1,2589,229,4],[1,2593,230,6],[1,2599,230,12,"token"],[1,2607,230,26,"AsyncStorage"],[1,2609,230,38,"default"],[1,2617,230,39,"getItem"],[1,2625,230,47],[1,2642,231,10,"token"],[1,2645,233,8,"axios"],[1,2647,233,13,"default"],[1,2655,233,14,"post"],[1,2660,233,19],[1,2663,233,22,"BACKEND_URL"],[1,2683,233,53],[1,2684,233,54],[1,2686,233,57],[1,2687,234,10,"headers"],[1,2695,234,19],[1,2696,234,21,"Authorization"],[1,2710,234,36],[1,2720,234,46,"token"],[1,2727,235,11,"catch"],[1,2733,235,17],[1,2740,237,4],[1,2741,237,6],[1,2747,237,13,"error"],[1,2750,238,6,"console"],[1,2758,238,14,"error"],[1,2764,238,20],[1,2780,238,37,"error"],[1,2782,239,4],[1,2783,242,4,"AsyncStorage"],[1,2785,242,16,"default"],[1,2793,242,17,"removeItem"],[1,2804,242,28],[1,2821,242,45,"catch"],[1,2827,242,51],[1,2835,243,4,"setUser"],[1,2837,243,12],[1,2844,287,65,"refreshUser"],[1,2856,251,22,"async"],[1,2866,252,4],[1,2870,253,6],[1,2876,253,12,"token"],[1,2884,253,26,"AsyncStorage"],[1,2886,253,38,"default"],[1,2894,253,39,"getItem"],[1,2902,253,47],[1,2919,254,6],[1,2922,254,10,"token"],[1,2924,254,17],[1,2925,256,8],[1,2931,256,14,"response"],[1,2939,256,31,"axios"],[1,2941,256,36,"default"],[1,2949,256,37,"get"],[1,2953,256,41],[1,2956,256,44,"BACKEND_URL"],[1,2976,256,74,"Date"],[1,2981,256,79,"now"],[1,2989,256,88],[1,2990,257,10,"headers"],[1,2998,257,19],[1,2999,258,12,"Authorization"],[1,3013,258,27],[1,3023,258,37,"token"],[1,3027,259,12],[1,3043,259,29],[1,3054,260,12,"Pragma"],[1,3061,260,22],[1,3075,263,8,"setUser"],[1,3077,263,16,"response"],[1,3079,263,25,"data"],[1,3084,264,6],[1,3085,265,4],[1,3086,265,6],[1,3092,265,13,"error"],[1,3095,266,6,"console"],[1,3103,266,14,"error"],[1,3109,266,20],[1,3131,266,43,"error"],[1,3133,267,4],[1,3137,287,79,"children"],[1,3146,288,7,"children"],[1,3150,291,2],[1,3153]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.refreshUser","useAuth","AuthProvider","useEffect$argument_0","sendHeartbeat","AsyncStorage.getItem.then$argument_0","axios.post._catch$argument_0","AsyncStorage.getItem.then._catch$argument_0","<anonymous>","setupPushNotifications","addNotificationReceivedListener$argument_0","addNotificationResponseReceivedListener$argument_0","checkExistingSession","login","handleAuthRedirect","logout","AsyncStorage.removeItem._catch$argument_0","refreshUser","handleWebAuth"],"mappings":"AAA;SCuC,cD;UEC,cF;eGC,cH;uBIG,6BJ;qEKE;YCK;GDE;YCG;GDK;YCG;0BCO;iDCG;mBCK,QD;ODE,QG,QH;KDC;WKQ;KLI;GDC;iCOE;mECkB;ODE;uEEE;OFQ;aDE;OCG;GPI;+BUE;GVgB;gBWE;GXyB;6BYE;GZ0C;iBaE;iBTO,QS;mDCO,QD;GbO;sBeE;GfiB;YCG;4BeE;OfO;GDI;CLO"},"hasCjsExports":false},"type":"js/module"}]}