{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-linking","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":40,"index":119}}],"key":"UOn5wJuCXvTT9EneNUmI6H0GQgM=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":120},"end":{"line":3,"column":47,"index":167}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":168},"end":{"line":4,"column":69,"index":237}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":279},"end":{"line":6,"column":26,"index":305}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"../services/notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":306},"end":{"line":12,"column":35,"index":491}}],"key":"PilFUkBfYpg1cVGLNRiWDw/oULQ=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}),t.default=e,t}function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return d}}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return f}});var o=r(_d[0]),n=(e(r(_d[1])),e(r(_d[2])),t(r(_d[3])));r(_d[4]);var s=t(r(_d[5])),c=(r(_d[6]),r(_d[7]));const u=\"https://risapp-production.up.railway.app\",l=(0,o.createContext)({user:null,loading:!0,login:async()=>{},logout:async()=>{},refreshUser:async()=>{}}),d=()=>(0,o.useContext)(l),f=({children:e})=>{const[t,d]=(0,o.useState)(null),[f,h]=(0,o.useState)(!0);(0,o.useEffect)(()=>{w()},[]),(0,o.useEffect)(()=>{},[t]),(0,o.useEffect)(()=>{if(!t)return;const e=async()=>{try{const e=await n.default.getItem('session_token');e&&s.default.post(`${u}/api/auth/heartbeat`,{},{headers:{Authorization:`Bearer ${e}`}}).catch(()=>{})}catch(e){}};setTimeout(e,5e3);const o=setInterval(e,12e4);return()=>clearInterval(o)},[t]);const w=async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});d(t.data)}}catch(e){console.error('Session check error:',e),await n.default.removeItem('session_token')}finally{h(!1)}},p=async e=>{try{let t=null;if(e.includes('#session_id=')?t=e.split('#session_id=')[1].split('&')[0]:e.includes('?session_id=')&&(t=e.split('?session_id=')[1].split('&')[0]),!t)throw new Error('No session_id found in redirect URL');const o=await s.default.post(`${u}/api/auth/session`,{},{headers:{'X-Session-ID':t}}),{session_token:c,...l}=o.data;await n.default.setItem('session_token',c);const f=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${c}`}});d(f.data)}catch(e){throw console.error('Auth redirect error:',e),e}};return(0,o.useEffect)(()=>{(async()=>{window.location.hash.includes('session_id=')&&(await p(window.location.href),window.history.replaceState({},document.title,window.location.pathname))})()},[]),(0,c.jsx)(l.Provider,{value:{user:t,loading:f,login:async()=>{try{h(!0);const e='undefined'!=typeof window?window.location.origin+'/':`${u}/`,t=`https://auth.emergentagent.com/?redirect=${encodeURIComponent(e)}`;window.location.href=t}catch(e){console.error('Login error:',e),h(!1)}},logout:async()=>{try{const e=await n.default.getItem('session_token');e&&await s.default.post(`${u}/api/auth/logout`,{},{headers:{Authorization:`Bearer ${e}`}})}catch(e){console.error('Logout error:',e)}finally{await n.default.removeItem('session_token'),d(null)}},refreshUser:async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me?_t=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`,'Cache-Control':'no-cache',Pragma:'no-cache'}});d(t.data)}}catch(e){console.error('Refresh user error:',e)}}},children:e})}});","lineCount":1,"map":[[1,378,45,0,"Object"],[1,385,45,0,"defineProperty"],[1,400,45,0,"_e"],[1,403,45,0],[1,414,45,0,"enumerable"],[1,426,45,0],[1,428,45,0,"get"],[1,432,45,0],[1,450,45,0,"useAuth"],[1,451,45,0],[1,455,47,0,"Object"],[1,462,47,0,"defineProperty"],[1,477,47,0,"_e"],[1,480,47,0],[1,496,47,0,"enumerable"],[1,508,47,0],[1,510,47,0,"get"],[1,514,47,0],[1,532,47,0,"AuthProvider"],[1,533,47,0],[1,537,1,0],[1,541,1,0,"_react"],[1,543,1,0,"r"],[1,545,1,0,"_d"],[1,548,1,0],[1,552,4,0,"AsyncStorage"],[1,555,2,0,"_interopNamespace"],[1,557,2,0,"r"],[1,559,2,0,"_d"],[1,562,2,0],[1,567,3,0,"_interopNamespace"],[1,569,3,0,"r"],[1,571,3,0,"_d"],[1,574,3,0],[1,579,4,0,"_interopDefault"],[1,581,4,0,"r"],[1,583,4,0,"_d"],[1,586,4,0],[1,592,4,69,"r"],[1,594,4,69,"_d"],[1,597,4,69],[1,601,6,0],[1,605,6,0,"axios"],[1,607,6,0,"_interopDefault"],[1,609,6,0,"r"],[1,611,6,0,"_d"],[1,614,6,0],[1,619,12,35,"_reactJsxRuntime"],[1,622,7,0,"r"],[1,624,7,0,"_d"],[1,627,7,0],[1,631,12,35,"r"],[1,633,12,35,"_d"],[1,636,12,35],[1,641,14,0],[1,647,14,6,"BACKEND_URL"],[1,649,14,17],[1,692,37,6,"AuthContext"],[1,695,37,20],[1,697,37,20,"createContext"],[1,699,37,33,"createContext"],[1,714,37,51],[1,715,38,2,"user"],[1,720,38,8],[1,725,39,2,"loading"],[1,734,39,11],[1,736,40,2,"login"],[1,742,40,9,"async"],[1,754,41,2,"logout"],[1,761,41,10,"async"],[1,773,42,2,"refreshUser"],[1,785,42,15,"async"],[1,799,45,13,"useAuth"],[1,801,45,23,"useAuth"],[1,806,45,29],[1,808,45,29,"useContext"],[1,810,45,39,"useContext"],[1,822,45,40,"AuthContext"],[1,825,47,13,"AuthProvider"],[1,827,47,69,"AuthProvider"],[1,829,47,72,"children"],[1,844,48,2],[1,850,48,9,"user"],[1,852,48,15,"setUser"],[1,856,48,26],[1,858,48,26,"useState"],[1,860,48,34,"useState"],[1,870,48,48],[1,877,49,9,"loading"],[1,879,49,18,"setLoading"],[1,883,49,32],[1,885,49,32,"useState"],[1,887,49,40,"useState"],[1,898,49,41],[1,902,52,2],[1,904,52,2,"useEffect"],[1,906,52,11,"useEffect"],[1,917,52,12],[1,922,53,4,"checkExistingSession"],[1,927,54,5],[1,932,57,2],[1,934,57,2,"useEffect"],[1,936,57,11,"useEffect"],[1,947,57,12],[1,954,61,5],[1,955,61,6,"user"],[1,960,64,2],[1,962,64,2,"useEffect"],[1,964,64,11,"useEffect"],[1,975,64,12],[1,980,65,4],[1,984,65,9,"user"],[1,986,65,15],[1,993,67,4],[1,999,67,10,"sendHeartbeat"],[1,1001,67,26,"async"],[1,1011,68,6],[1,1015,69,8],[1,1021,69,14,"token"],[1,1029,69,28,"AsyncStorage"],[1,1031,69,40,"default"],[1,1039,69,41,"getItem"],[1,1047,69,49],[1,1064,70,12,"token"],[1,1067,71,10,"axios"],[1,1069,71,15,"default"],[1,1077,71,16,"post"],[1,1082,71,21],[1,1085,71,24,"BACKEND_URL"],[1,1108,71,58],[1,1109,71,59],[1,1111,71,62],[1,1112,72,12,"headers"],[1,1120,72,21],[1,1121,72,23,"Authorization"],[1,1135,72,38],[1,1145,72,48,"token"],[1,1152,73,13,"catch"],[1,1158,73,19],[1,1165,75,6],[1,1166,75,8],[1,1172,75,15,"error"],[1,1175,76,8],[1,1178,81,4,"setTimeout"],[1,1189,81,15,"sendHeartbeat"],[1,1191,81,30],[1,1196,84,4],[1,1202,84,10,"interval"],[1,1204,84,21,"setInterval"],[1,1216,84,33,"sendHeartbeat"],[1,1218,84,48],[1,1224,86,4],[1,1230,86,11],[1,1234,86,17,"clearInterval"],[1,1248,86,31,"interval"],[1,1252,87,5],[1,1253,87,6,"user"],[1,1257,120,2],[1,1263,120,8,"checkExistingSession"],[1,1265,120,31,"async"],[1,1275,121,4],[1,1279,122,6],[1,1285,122,12,"token"],[1,1293,122,26,"AsyncStorage"],[1,1295,122,38,"default"],[1,1303,122,39,"getItem"],[1,1311,122,47],[1,1328,123,6],[1,1331,123,10,"token"],[1,1333,123,17],[1,1334,125,8],[1,1340,125,14,"response"],[1,1348,125,31,"axios"],[1,1350,125,36,"default"],[1,1358,125,37,"get"],[1,1362,125,41],[1,1365,125,44,"BACKEND_URL"],[1,1381,125,71],[1,1382,126,10,"headers"],[1,1390,126,19],[1,1391,126,21,"Authorization"],[1,1405,126,36],[1,1415,126,46,"token"],[1,1422,128,8,"setUser"],[1,1424,128,16,"response"],[1,1426,128,25,"data"],[1,1431,129,6],[1,1432,130,4],[1,1433,130,6],[1,1439,130,13,"error"],[1,1442,131,6,"console"],[1,1450,131,14,"error"],[1,1456,131,20],[1,1479,131,44,"error"],[1,1488,132,12,"AsyncStorage"],[1,1490,132,24,"default"],[1,1498,132,25,"removeItem"],[1,1509,132,36],[1,1525,133,4],[1,1526,133,5],[1,1534,134,6,"setLoading"],[1,1537,134,17],[1,1539,135,4],[1,1542,165,8,"handleAuthRedirect"],[1,1544,165,29,"async"],[1,1554,166,4],[1,1558,168,6],[1,1562,168,10,"sessionId"],[1,1564,168,22],[1,1569,179,6],[1,1572,171,10,"url"],[1,1574,171,14,"includes"],[1,1583,171,23],[1,1599,172,8,"sessionId"],[1,1601,172,20,"url"],[1,1603,172,24,"split"],[1,1609,172,30],[1,1625,172,46],[1,1628,172,49,"split"],[1,1634,172,55],[1,1639,172,60],[1,1642,175,15,"url"],[1,1644,175,19,"includes"],[1,1653,175,28],[1,1671,176,8,"sessionId"],[1,1673,176,20,"url"],[1,1675,176,24,"split"],[1,1681,176,30],[1,1697,176,46],[1,1700,176,49,"split"],[1,1706,176,55],[1,1711,176,60],[1,1716,179,11,"sessionId"],[1,1718,180,8],[1,1724,180,14],[1,1728,180,18,"Error"],[1,1734,180,24],[1,1773,184,6],[1,1779,184,12,"response"],[1,1787,184,29,"axios"],[1,1789,184,34,"default"],[1,1797,184,35,"post"],[1,1802,185,8],[1,1805,185,11,"BACKEND_URL"],[1,1826,186,8],[1,1827,186,9],[1,1829,187,8],[1,1830,188,10,"headers"],[1,1838,188,19],[1,1839,188,21],[1,1854,188,37,"sessionId"],[1,1860,192,12,"session_token"],[1,1874,192,14,"session_token"],[1,1879,192,32,"userData"],[1,1882,192,45,"response"],[1,1884,192,54,"data"],[1,1895,195,12,"AsyncStorage"],[1,1897,195,24,"default"],[1,1905,195,25,"setItem"],[1,1913,195,33],[1,1929,195,50,"session_token"],[1,1932,198,6],[1,1938,198,12,"userResponse"],[1,1946,198,33,"axios"],[1,1948,198,38,"default"],[1,1956,198,39,"get"],[1,1960,198,43],[1,1963,198,46,"BACKEND_URL"],[1,1979,198,73],[1,1980,199,8,"headers"],[1,1988,199,17],[1,1989,199,19,"Authorization"],[1,2003,199,34],[1,2013,199,44,"session_token"],[1,2020,202,6,"setUser"],[1,2022,202,14,"userResponse"],[1,2024,202,27,"data"],[1,2029,203,4],[1,2030,203,6],[1,2036,203,13,"error"],[1,2039,205,6],[1,2045,204,6,"console"],[1,2053,204,14,"error"],[1,2059,204,20],[1,2082,204,44,"error"],[1,2085,205,12,"error"],[1,2086,206,4],[1,2089,260,2],[1,2096,245,2],[1,2098,245,2,"useEffect"],[1,2100,245,11,"useEffect"],[1,2111,245,12],[1,2116,247,28,"async"],[1,2127,248,21,"window"],[1,2134,248,28,"location"],[1,2143,248,37,"hash"],[1,2148,249,17,"includes"],[1,2157,249,26],[1,2180,250,16,"handleAuthRedirect"],[1,2182,250,35,"window"],[1,2189,250,42,"location"],[1,2198,250,51,"href"],[1,2204,252,10,"window"],[1,2211,252,17,"history"],[1,2219,252,25,"replaceState"],[1,2232,252,38],[1,2233,252,39],[1,2235,252,42,"document"],[1,2244,252,51,"title"],[1,2250,252,58,"window"],[1,2257,252,65,"location"],[1,2266,252,74,"pathname"],[1,2278,256,6,"handleWebAuth"],[1,2282,258,5],[1,2287,261,4],[1,2289,261,4,"_reactJsxRuntime"],[1,2291,261,4,"jsx"],[1,2296,261,5,"AuthContext"],[1,2298,261,17,"Provider"],[1,2307,261,25],[1,2308,261,26,"value"],[1,2314,261,33],[1,2315,261,35,"user"],[1,2322,261,41,"loading"],[1,2332,261,50,"login"],[1,2338,138,16,"async"],[1,2348,139,4],[1,2352,140,6,"setLoading"],[1,2355,140,17],[1,2358,142,6],[1,2364,142,12,"redirectUrl"],[1,2366,143,29],[1,2386,143,18,"window"],[1,2393,143,43,"window"],[1,2400,143,50,"location"],[1,2409,143,59,"origin"],[1,2416,143,68],[1,2420,143,74],[1,2423,143,77,"BACKEND_URL"],[1,2428,146,12,"authUrl"],[1,2430,146,22],[1,2474,146,66,"encodeURIComponent"],[1,2493,146,85,"redirectUrl"],[1,2498,150,8,"window"],[1,2505,150,15,"location"],[1,2514,150,24,"href"],[1,2519,150,31,"authUrl"],[1,2520,159,4],[1,2521,159,6],[1,2527,159,13,"error"],[1,2530,160,6,"console"],[1,2538,160,14,"error"],[1,2544,160,20],[1,2559,160,36,"error"],[1,2562,161,6,"setLoading"],[1,2565,161,17],[1,2567,162,4],[1,2570,261,57,"logout"],[1,2577,209,17,"async"],[1,2587,210,4],[1,2591,211,6],[1,2597,211,12,"token"],[1,2605,211,26,"AsyncStorage"],[1,2607,211,38,"default"],[1,2615,211,39,"getItem"],[1,2623,211,47],[1,2640,212,10,"token"],[1,2649,213,14,"axios"],[1,2651,213,19,"default"],[1,2659,213,20,"post"],[1,2664,213,25],[1,2667,213,28,"BACKEND_URL"],[1,2687,213,59],[1,2688,213,60],[1,2690,213,63],[1,2691,214,10,"headers"],[1,2699,214,19],[1,2700,214,21,"Authorization"],[1,2714,214,36],[1,2724,214,46,"token"],[1,2730,217,4],[1,2731,217,6],[1,2737,217,13,"error"],[1,2740,218,6,"console"],[1,2748,218,14,"error"],[1,2754,218,20],[1,2770,218,37,"error"],[1,2772,219,4],[1,2773,219,5],[1,2787,220,12,"AsyncStorage"],[1,2789,220,24,"default"],[1,2797,220,25,"removeItem"],[1,2808,220,36],[1,2825,221,6,"setUser"],[1,2827,221,14],[1,2832,222,4],[1,2835,261,65,"refreshUser"],[1,2847,225,22,"async"],[1,2857,226,4],[1,2861,227,6],[1,2867,227,12,"token"],[1,2875,227,26,"AsyncStorage"],[1,2877,227,38,"default"],[1,2885,227,39,"getItem"],[1,2893,227,47],[1,2910,228,6],[1,2913,228,10,"token"],[1,2915,228,17],[1,2916,230,8],[1,2922,230,14,"response"],[1,2930,230,31,"axios"],[1,2932,230,36,"default"],[1,2940,230,37,"get"],[1,2944,230,41],[1,2947,230,44,"BACKEND_URL"],[1,2967,230,74,"Date"],[1,2972,230,79,"now"],[1,2980,230,88],[1,2981,231,10,"headers"],[1,2989,231,19],[1,2990,232,12,"Authorization"],[1,3004,232,27],[1,3014,232,37,"token"],[1,3018,233,12],[1,3034,233,29],[1,3045,234,12,"Pragma"],[1,3052,234,22],[1,3066,237,8,"setUser"],[1,3068,237,16,"response"],[1,3070,237,25,"data"],[1,3075,238,6],[1,3076,239,4],[1,3077,239,6],[1,3083,239,13,"error"],[1,3086,240,6,"console"],[1,3094,240,14,"error"],[1,3100,240,20],[1,3122,240,43,"error"],[1,3124,241,4],[1,3128,261,79,"children"],[1,3137,262,7,"children"],[1,3141,265,2],[1,3144]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.refreshUser","useAuth","AuthProvider","useEffect$argument_0","sendHeartbeat","axios.post._catch$argument_0","<anonymous>","setupPushNotifications","addNotificationReceivedListener$argument_0","addNotificationResponseReceivedListener$argument_0","checkExistingSession","login","handleAuthRedirect","logout","refreshUser","handleWebAuth"],"mappings":"AAA;SCuC,cD;UEC,cF;eGC,cH;uBIG,6BJ;qEKE;YCK;GDE;YCG;GDI;YCG;0BCG;mBCM,QD;KDK;WGQ,6BH;GDC;iCKE;mECQ;ODE;uEEE;OFQ;aDE;OCG;GLI;+BQE;GRgB;gBSE;GTyB;6BUE;GV0C;iBWE;GXc;sBYE;GZiB;YCG;4BYE;OZO;GDI;CLO"},"hasCjsExports":false},"type":"js/module"}]}