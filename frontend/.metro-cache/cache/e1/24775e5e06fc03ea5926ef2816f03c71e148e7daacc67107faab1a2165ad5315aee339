{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-linking","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":40,"index":119}}],"key":"UOn5wJuCXvTT9EneNUmI6H0GQgM=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":120},"end":{"line":3,"column":47,"index":167}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":168},"end":{"line":4,"column":69,"index":237}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":279},"end":{"line":6,"column":26,"index":305}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"../services/notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":306},"end":{"line":12,"column":35,"index":491}}],"key":"PilFUkBfYpg1cVGLNRiWDw/oULQ=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}),t.default=e,t}function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return d}}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return h}});var o=r(_d[0]),n=(e(r(_d[1])),e(r(_d[2])),t(r(_d[3])));r(_d[4]);var s=t(r(_d[5])),c=(r(_d[6]),r(_d[7]));const u=\"https://support-chat-21.preview.emergentagent.com\",l=(0,o.createContext)({user:null,loading:!0,login:async()=>{},logout:async()=>{},refreshUser:async()=>{}}),d=()=>(0,o.useContext)(l),h=({children:e})=>{const[t,d]=(0,o.useState)(null),[h,f]=(0,o.useState)(!0);(0,o.useEffect)(()=>{w()},[]),(0,o.useEffect)(()=>{0},[t]),(0,o.useEffect)(()=>{if(!t)return;let e=!0,o=null,c=null;const l=()=>{e&&n.default.getItem('session_token').then(t=>{t&&e&&s.default.post(`${u}/api/auth/heartbeat`,{},{headers:{Authorization:`Bearer ${t}`},timeout:5e3}).catch(()=>{})}).catch(()=>{})};return o=setTimeout(l,5e3),c=setInterval(l,12e4),()=>{e=!1,o&&clearTimeout(o),c&&clearInterval(c)}},[t]);const w=async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});d(t.data)}}catch(e){console.error('Session check error:',e),await n.default.removeItem('session_token')}finally{f(!1)}},p=async e=>{try{let t=null;if(e.includes('#session_id=')?t=e.split('#session_id=')[1].split('&')[0]:e.includes('?session_id=')&&(t=e.split('?session_id=')[1].split('&')[0]),!t)throw new Error('No session_id found in redirect URL');const o=await s.default.post(`${u}/api/auth/session`,{},{headers:{'X-Session-ID':t}}),{session_token:c,...l}=o.data;await n.default.setItem('session_token',c);const h=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${c}`}});d(h.data)}catch(e){throw console.error('Auth redirect error:',e),e}};return(0,o.useEffect)(()=>{(async()=>{window.location.hash.includes('session_id=')&&(await p(window.location.href),window.history.replaceState({},document.title,window.location.pathname))})()},[]),(0,c.jsx)(l.Provider,{value:{user:t,loading:h,login:async()=>{try{f(!0);const e='undefined'!=typeof window?window.location.origin+'/':`${u}/`,t=`https://auth.emergentagent.com/?redirect=${encodeURIComponent(e)}`;window.location.href=t}catch(e){console.error('Login error:',e),f(!1)}},logout:async()=>{try{const e=await n.default.getItem('session_token');e&&s.default.post(`${u}/api/auth/logout`,{},{headers:{Authorization:`Bearer ${e}`}}).catch(()=>{})}catch(e){console.error('Logout error:',e)}n.default.removeItem('session_token').catch(()=>{}),d(null),'undefined'!=typeof window&&window.location.replace('/login')},refreshUser:async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me?_t=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`,'Cache-Control':'no-cache',Pragma:'no-cache'}});d(t.data)}}catch(e){console.error('Refresh user error:',e)}}},children:e})}});","lineCount":1,"map":[[1,378,45,0,"Object"],[1,385,45,0,"defineProperty"],[1,400,45,0,"_e"],[1,403,45,0],[1,414,45,0,"enumerable"],[1,426,45,0],[1,428,45,0,"get"],[1,432,45,0],[1,450,45,0,"useAuth"],[1,451,45,0],[1,455,47,0,"Object"],[1,462,47,0,"defineProperty"],[1,477,47,0,"_e"],[1,480,47,0],[1,496,47,0,"enumerable"],[1,508,47,0],[1,510,47,0,"get"],[1,514,47,0],[1,532,47,0,"AuthProvider"],[1,533,47,0],[1,537,1,0],[1,541,1,0,"_react"],[1,543,1,0,"r"],[1,545,1,0,"_d"],[1,548,1,0],[1,552,4,0,"AsyncStorage"],[1,555,2,0,"_interopNamespace"],[1,557,2,0,"r"],[1,559,2,0,"_d"],[1,562,2,0],[1,567,3,0,"_interopNamespace"],[1,569,3,0,"r"],[1,571,3,0,"_d"],[1,574,3,0],[1,579,4,0,"_interopDefault"],[1,581,4,0,"r"],[1,583,4,0,"_d"],[1,586,4,0],[1,592,4,69,"r"],[1,594,4,69,"_d"],[1,597,4,69],[1,601,6,0],[1,605,6,0,"axios"],[1,607,6,0,"_interopDefault"],[1,609,6,0,"r"],[1,611,6,0,"_d"],[1,614,6,0],[1,619,12,35,"_reactJsxRuntime"],[1,622,7,0,"r"],[1,624,7,0,"_d"],[1,627,7,0],[1,631,12,35,"r"],[1,633,12,35,"_d"],[1,636,12,35],[1,641,14,0],[1,647,14,6,"BACKEND_URL"],[1,649,14,17],[1,701,37,6,"AuthContext"],[1,704,37,20],[1,706,37,20,"createContext"],[1,708,37,33,"createContext"],[1,723,37,51],[1,724,38,2,"user"],[1,729,38,8],[1,734,39,2,"loading"],[1,743,39,11],[1,745,40,2,"login"],[1,751,40,9,"async"],[1,763,41,2,"logout"],[1,770,41,10,"async"],[1,782,42,2,"refreshUser"],[1,794,42,15,"async"],[1,808,45,13,"useAuth"],[1,810,45,23,"useAuth"],[1,815,45,29],[1,817,45,29,"useContext"],[1,819,45,39,"useContext"],[1,831,45,40,"AuthContext"],[1,834,47,13,"AuthProvider"],[1,836,47,69,"AuthProvider"],[1,838,47,72,"children"],[1,853,48,2],[1,859,48,9,"user"],[1,861,48,15,"setUser"],[1,865,48,26],[1,867,48,26,"useState"],[1,869,48,34,"useState"],[1,879,48,48],[1,886,49,9,"loading"],[1,888,49,18,"setLoading"],[1,892,49,32],[1,894,49,32,"useState"],[1,896,49,40,"useState"],[1,907,49,41],[1,911,52,2],[1,913,52,2,"useEffect"],[1,915,52,11,"useEffect"],[1,926,52,12],[1,931,53,4,"checkExistingSession"],[1,936,54,5],[1,941,57,2],[1,943,57,2,"useEffect"],[1,945,57,11,"useEffect"],[1,956,57,12],[1,961,58,8,"user"],[1,964,62,5],[1,965,62,6,"user"],[1,970,65,2],[1,972,65,2,"useEffect"],[1,974,65,11,"useEffect"],[1,985,65,12],[1,990,66,4],[1,994,66,9,"user"],[1,996,66,15],[1,1003,68,4],[1,1007,68,8,"isActive"],[1,1010,68,19],[1,1012,69,8,"timeoutId"],[1,1014,69,43],[1,1019,70,8,"intervalId"],[1,1021,70,44],[1,1026,72,4],[1,1032,72,10,"sendHeartbeat"],[1,1034,72,26,"sendHeartbeat"],[1,1039,73,11,"isActive"],[1,1042,75,6,"AsyncStorage"],[1,1044,75,18,"default"],[1,1052,75,19,"getItem"],[1,1060,75,27],[1,1077,75,44,"then"],[1,1082,75,49,"token"],[1,1086,76,12,"token"],[1,1089,76,21,"isActive"],[1,1092,77,10,"axios"],[1,1094,77,15,"default"],[1,1102,77,16,"post"],[1,1107,77,21],[1,1110,77,24,"BACKEND_URL"],[1,1133,77,58],[1,1134,77,59],[1,1136,77,62],[1,1137,78,12,"headers"],[1,1145,78,21],[1,1146,78,23,"Authorization"],[1,1160,78,38],[1,1170,78,48,"token"],[1,1175,79,12,"timeout"],[1,1183,79,21],[1,1189,80,13,"catch"],[1,1195,80,19],[1,1205,82,9,"catch"],[1,1211,82,15],[1,1220,91,4],[1,1227,86,4,"timeoutId"],[1,1229,86,16,"setTimeout"],[1,1240,86,27,"sendHeartbeat"],[1,1242,86,42],[1,1247,89,4,"intervalId"],[1,1249,89,17,"setInterval"],[1,1261,89,29,"sendHeartbeat"],[1,1263,89,44],[1,1269,91,11],[1,1274,92,6,"isActive"],[1,1277,92,17],[1,1279,93,10,"timeoutId"],[1,1282,93,21,"clearTimeout"],[1,1295,93,34,"timeoutId"],[1,1298,94,10,"intervalId"],[1,1301,94,22,"clearInterval"],[1,1315,94,36,"intervalId"],[1,1320,96,5],[1,1321,96,6,"user"],[1,1325,98,2],[1,1331,139,8,"checkExistingSession"],[1,1333,139,31,"async"],[1,1343,140,4],[1,1347,141,6],[1,1353,141,12,"token"],[1,1361,141,26,"AsyncStorage"],[1,1363,141,38,"default"],[1,1371,141,39,"getItem"],[1,1379,141,47],[1,1396,142,6],[1,1399,142,10,"token"],[1,1401,142,17],[1,1402,144,8],[1,1408,144,14,"response"],[1,1416,144,31,"axios"],[1,1418,144,36,"default"],[1,1426,144,37,"get"],[1,1430,144,41],[1,1433,144,44,"BACKEND_URL"],[1,1449,144,71],[1,1450,145,10,"headers"],[1,1458,145,19],[1,1459,145,21,"Authorization"],[1,1473,145,36],[1,1483,145,46,"token"],[1,1490,147,8,"setUser"],[1,1492,147,16,"response"],[1,1494,147,25,"data"],[1,1499,148,6],[1,1500,149,4],[1,1501,149,6],[1,1507,149,13,"error"],[1,1510,150,6,"console"],[1,1518,150,14,"error"],[1,1524,150,20],[1,1547,150,44,"error"],[1,1556,151,12,"AsyncStorage"],[1,1558,151,24,"default"],[1,1566,151,25,"removeItem"],[1,1577,151,36],[1,1593,152,4],[1,1594,152,5],[1,1602,153,6,"setLoading"],[1,1605,153,17],[1,1607,154,4],[1,1610,184,8,"handleAuthRedirect"],[1,1612,184,29,"async"],[1,1622,185,4],[1,1626,187,6],[1,1630,187,10,"sessionId"],[1,1632,187,22],[1,1637,198,6],[1,1640,190,10,"url"],[1,1642,190,14,"includes"],[1,1651,190,23],[1,1667,191,8,"sessionId"],[1,1669,191,20,"url"],[1,1671,191,24,"split"],[1,1677,191,30],[1,1693,191,46],[1,1696,191,49,"split"],[1,1702,191,55],[1,1707,191,60],[1,1710,194,15,"url"],[1,1712,194,19,"includes"],[1,1721,194,28],[1,1739,195,8,"sessionId"],[1,1741,195,20,"url"],[1,1743,195,24,"split"],[1,1749,195,30],[1,1765,195,46],[1,1768,195,49,"split"],[1,1774,195,55],[1,1779,195,60],[1,1784,198,11,"sessionId"],[1,1786,199,8],[1,1792,199,14],[1,1796,199,18,"Error"],[1,1802,199,24],[1,1841,203,6],[1,1847,203,12,"response"],[1,1855,203,29,"axios"],[1,1857,203,34,"default"],[1,1865,203,35,"post"],[1,1870,204,8],[1,1873,204,11,"BACKEND_URL"],[1,1894,205,8],[1,1895,205,9],[1,1897,206,8],[1,1898,207,10,"headers"],[1,1906,207,19],[1,1907,207,21],[1,1922,207,37,"sessionId"],[1,1928,211,12,"session_token"],[1,1942,211,14,"session_token"],[1,1947,211,32,"userData"],[1,1950,211,45,"response"],[1,1952,211,54,"data"],[1,1963,214,12,"AsyncStorage"],[1,1965,214,24,"default"],[1,1973,214,25,"setItem"],[1,1981,214,33],[1,1997,214,50,"session_token"],[1,2000,217,6],[1,2006,217,12,"userResponse"],[1,2014,217,33,"axios"],[1,2016,217,38,"default"],[1,2024,217,39,"get"],[1,2028,217,43],[1,2031,217,46,"BACKEND_URL"],[1,2047,217,73],[1,2048,218,8,"headers"],[1,2056,218,17],[1,2057,218,19,"Authorization"],[1,2071,218,34],[1,2081,218,44,"session_token"],[1,2088,221,6,"setUser"],[1,2090,221,14,"userResponse"],[1,2092,221,27,"data"],[1,2097,222,4],[1,2098,222,6],[1,2104,222,13,"error"],[1,2107,224,6],[1,2113,223,6,"console"],[1,2121,223,14,"error"],[1,2127,223,20],[1,2150,223,44,"error"],[1,2153,224,12,"error"],[1,2154,225,4],[1,2157,286,2],[1,2164,271,2],[1,2166,271,2,"useEffect"],[1,2168,271,11,"useEffect"],[1,2179,271,12],[1,2184,273,28,"async"],[1,2195,274,21,"window"],[1,2202,274,28,"location"],[1,2211,274,37,"hash"],[1,2216,275,17,"includes"],[1,2225,275,26],[1,2248,276,16,"handleAuthRedirect"],[1,2250,276,35,"window"],[1,2257,276,42,"location"],[1,2266,276,51,"href"],[1,2272,278,10,"window"],[1,2279,278,17,"history"],[1,2287,278,25,"replaceState"],[1,2300,278,38],[1,2301,278,39],[1,2303,278,42,"document"],[1,2312,278,51,"title"],[1,2318,278,58,"window"],[1,2325,278,65,"location"],[1,2334,278,74,"pathname"],[1,2346,282,6,"handleWebAuth"],[1,2350,284,5],[1,2355,287,4],[1,2357,287,4,"_reactJsxRuntime"],[1,2359,287,4,"jsx"],[1,2364,287,5,"AuthContext"],[1,2366,287,17,"Provider"],[1,2375,287,25],[1,2376,287,26,"value"],[1,2382,287,33],[1,2383,287,35,"user"],[1,2390,287,41,"loading"],[1,2400,287,50,"login"],[1,2406,157,16,"async"],[1,2416,158,4],[1,2420,159,6,"setLoading"],[1,2423,159,17],[1,2426,161,6],[1,2432,161,12,"redirectUrl"],[1,2434,162,29],[1,2454,162,18,"window"],[1,2461,162,43,"window"],[1,2468,162,50,"location"],[1,2477,162,59,"origin"],[1,2484,162,68],[1,2488,162,74],[1,2491,162,77,"BACKEND_URL"],[1,2496,165,12,"authUrl"],[1,2498,165,22],[1,2542,165,66,"encodeURIComponent"],[1,2561,165,85,"redirectUrl"],[1,2566,169,8,"window"],[1,2573,169,15,"location"],[1,2582,169,24,"href"],[1,2587,169,31,"authUrl"],[1,2588,178,4],[1,2589,178,6],[1,2595,178,13,"error"],[1,2598,179,6,"console"],[1,2606,179,14,"error"],[1,2612,179,20],[1,2627,179,36,"error"],[1,2630,180,6,"setLoading"],[1,2633,180,17],[1,2635,181,4],[1,2638,287,57,"logout"],[1,2645,228,17,"async"],[1,2655,229,4],[1,2659,230,6],[1,2665,230,12,"token"],[1,2673,230,26,"AsyncStorage"],[1,2675,230,38,"default"],[1,2683,230,39,"getItem"],[1,2691,230,47],[1,2708,231,10,"token"],[1,2711,233,8,"axios"],[1,2713,233,13,"default"],[1,2721,233,14,"post"],[1,2726,233,19],[1,2729,233,22,"BACKEND_URL"],[1,2749,233,53],[1,2750,233,54],[1,2752,233,57],[1,2753,234,10,"headers"],[1,2761,234,19],[1,2762,234,21,"Authorization"],[1,2776,234,36],[1,2786,234,46,"token"],[1,2793,235,11,"catch"],[1,2799,235,17],[1,2806,237,4],[1,2807,237,6],[1,2813,237,13,"error"],[1,2816,238,6,"console"],[1,2824,238,14,"error"],[1,2830,238,20],[1,2846,238,37,"error"],[1,2848,239,4],[1,2849,242,4,"AsyncStorage"],[1,2851,242,16,"default"],[1,2859,242,17,"removeItem"],[1,2870,242,28],[1,2887,242,45,"catch"],[1,2893,242,51],[1,2901,243,4,"setUser"],[1,2903,243,12],[1,2909,246,51],[1,2929,246,40,"window"],[1,2937,247,6,"window"],[1,2944,247,13,"location"],[1,2953,247,22,"replace"],[1,2961,247,30],[1,2972,287,65,"refreshUser"],[1,2984,251,22,"async"],[1,2994,252,4],[1,2998,253,6],[1,3004,253,12,"token"],[1,3012,253,26,"AsyncStorage"],[1,3014,253,38,"default"],[1,3022,253,39,"getItem"],[1,3030,253,47],[1,3047,254,6],[1,3050,254,10,"token"],[1,3052,254,17],[1,3053,256,8],[1,3059,256,14,"response"],[1,3067,256,31,"axios"],[1,3069,256,36,"default"],[1,3077,256,37,"get"],[1,3081,256,41],[1,3084,256,44,"BACKEND_URL"],[1,3104,256,74,"Date"],[1,3109,256,79,"now"],[1,3117,256,88],[1,3118,257,10,"headers"],[1,3126,257,19],[1,3127,258,12,"Authorization"],[1,3141,258,27],[1,3151,258,37,"token"],[1,3155,259,12],[1,3171,259,29],[1,3182,260,12,"Pragma"],[1,3189,260,22],[1,3203,263,8,"setUser"],[1,3205,263,16,"response"],[1,3207,263,25,"data"],[1,3212,264,6],[1,3213,265,4],[1,3214,265,6],[1,3220,265,13,"error"],[1,3223,266,6,"console"],[1,3231,266,14,"error"],[1,3237,266,20],[1,3259,266,43,"error"],[1,3261,267,4],[1,3265,287,79,"children"],[1,3274,288,7,"children"],[1,3278,291,2],[1,3281]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.refreshUser","useAuth","AuthProvider","useEffect$argument_0","sendHeartbeat","AsyncStorage.getItem.then$argument_0","axios.post._catch$argument_0","AsyncStorage.getItem.then._catch$argument_0","<anonymous>","setupPushNotifications","addNotificationReceivedListener$argument_0","addNotificationResponseReceivedListener$argument_0","checkExistingSession","login","handleAuthRedirect","logout","AsyncStorage.removeItem._catch$argument_0","refreshUser","handleWebAuth"],"mappings":"AAA;SCuC,cD;UEC,cF;eGC,cH;uBIG,6BJ;qEKE;YCK;GDE;YCG;GDK;YCG;0BCO;iDCG;mBCK,QD;ODE,QG,QH;KDC;WKQ;KLI;GDC;iCOE;mECkB;ODE;uEEE;OFQ;aDE;OCG;GPI;+BUE;GVgB;gBWE;GXyB;6BYE;GZ0C;iBaE;iBTO,QS;mDCO,QD;GbO;sBeE;GfiB;YCG;4BeE;OfO;GDI;CLO"},"hasCjsExports":false},"type":"js/module"}]}