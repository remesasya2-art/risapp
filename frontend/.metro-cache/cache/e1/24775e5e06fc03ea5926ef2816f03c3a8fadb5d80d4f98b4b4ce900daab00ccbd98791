{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-linking","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":40,"index":119}}],"key":"UOn5wJuCXvTT9EneNUmI6H0GQgM=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":120},"end":{"line":3,"column":47,"index":167}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":168},"end":{"line":4,"column":69,"index":237}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":279},"end":{"line":6,"column":26,"index":305}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"../services/notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":306},"end":{"line":12,"column":35,"index":491}}],"key":"PilFUkBfYpg1cVGLNRiWDw/oULQ=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}),t.default=e,t}function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return d}}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return h}});var o=r(_d[0]),n=(e(r(_d[1])),e(r(_d[2])),t(r(_d[3])));r(_d[4]);var s=t(r(_d[5])),c=(r(_d[6]),r(_d[7]));const u=\"https://risapp-production.up.railway.app\",l=(0,o.createContext)({user:null,loading:!0,login:async()=>{},logout:async()=>{},refreshUser:async()=>{}}),d=()=>(0,o.useContext)(l),h=({children:e})=>{const[t,d]=(0,o.useState)(null),[h,f]=(0,o.useState)(!0);(0,o.useEffect)(()=>{w()},[]),(0,o.useEffect)(()=>{0},[t]),(0,o.useEffect)(()=>{if(!t)return;let e=!0,o=null,c=null;const l=()=>{e&&n.default.getItem('session_token').then(t=>{t&&e&&s.default.post(`${u}/api/auth/heartbeat`,{},{headers:{Authorization:`Bearer ${t}`},timeout:5e3}).catch(()=>{})}).catch(()=>{})};return o=setTimeout(l,5e3),c=setInterval(l,12e4),()=>{e=!1,o&&clearTimeout(o),c&&clearInterval(c)}},[t]);const w=async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});d(t.data)}}catch(e){console.error('Session check error:',e),await n.default.removeItem('session_token')}finally{f(!1)}},p=async e=>{try{let t=null;if(e.includes('#session_id=')?t=e.split('#session_id=')[1].split('&')[0]:e.includes('?session_id=')&&(t=e.split('?session_id=')[1].split('&')[0]),!t)throw new Error('No session_id found in redirect URL');const o=await s.default.post(`${u}/api/auth/session`,{},{headers:{'X-Session-ID':t}}),{session_token:c,...l}=o.data;await n.default.setItem('session_token',c);const h=await s.default.get(`${u}/api/auth/me`,{headers:{Authorization:`Bearer ${c}`}});d(h.data)}catch(e){throw console.error('Auth redirect error:',e),e}};return(0,o.useEffect)(()=>{(async()=>{window.location.hash.includes('session_id=')&&(await p(window.location.href),window.history.replaceState({},document.title,window.location.pathname))})()},[]),(0,c.jsx)(l.Provider,{value:{user:t,loading:h,login:async()=>{try{f(!0);const e='undefined'!=typeof window?window.location.origin+'/':`${u}/`,t=`https://auth.emergentagent.com/?redirect=${encodeURIComponent(e)}`;window.location.href=t}catch(e){console.error('Login error:',e),f(!1)}},logout:async()=>{if('undefined'!=typeof window){try{localStorage.removeItem('session_token')}catch(e){}const e=localStorage.getItem('session_token');return e&&fetch(`${u}/api/auth/logout`,{method:'POST',headers:{Authorization:`Bearer ${e}`}}).catch(()=>{}),void(window.location.href='/login')}try{const e=await n.default.getItem('session_token');e&&s.default.post(`${u}/api/auth/logout`,{},{headers:{Authorization:`Bearer ${e}`}}).catch(()=>{})}catch(e){console.error('Logout error:',e)}await n.default.removeItem('session_token'),d(null)},refreshUser:async()=>{try{const e=await n.default.getItem('session_token');if(e){const t=await s.default.get(`${u}/api/auth/me?_t=${Date.now()}`,{headers:{Authorization:`Bearer ${e}`,'Cache-Control':'no-cache',Pragma:'no-cache'}});d(t.data)}}catch(e){console.error('Refresh user error:',e)}}},children:e})}});","lineCount":1,"map":[[1,378,45,0,"Object"],[1,385,45,0,"defineProperty"],[1,400,45,0,"_e"],[1,403,45,0],[1,414,45,0,"enumerable"],[1,426,45,0],[1,428,45,0,"get"],[1,432,45,0],[1,450,45,0,"useAuth"],[1,451,45,0],[1,455,47,0,"Object"],[1,462,47,0,"defineProperty"],[1,477,47,0,"_e"],[1,480,47,0],[1,496,47,0,"enumerable"],[1,508,47,0],[1,510,47,0,"get"],[1,514,47,0],[1,532,47,0,"AuthProvider"],[1,533,47,0],[1,537,1,0],[1,541,1,0,"_react"],[1,543,1,0,"r"],[1,545,1,0,"_d"],[1,548,1,0],[1,552,4,0,"AsyncStorage"],[1,555,2,0,"_interopNamespace"],[1,557,2,0,"r"],[1,559,2,0,"_d"],[1,562,2,0],[1,567,3,0,"_interopNamespace"],[1,569,3,0,"r"],[1,571,3,0,"_d"],[1,574,3,0],[1,579,4,0,"_interopDefault"],[1,581,4,0,"r"],[1,583,4,0,"_d"],[1,586,4,0],[1,592,4,69,"r"],[1,594,4,69,"_d"],[1,597,4,69],[1,601,6,0],[1,605,6,0,"axios"],[1,607,6,0,"_interopDefault"],[1,609,6,0,"r"],[1,611,6,0,"_d"],[1,614,6,0],[1,619,12,35,"_reactJsxRuntime"],[1,622,7,0,"r"],[1,624,7,0,"_d"],[1,627,7,0],[1,631,12,35,"r"],[1,633,12,35,"_d"],[1,636,12,35],[1,641,14,0],[1,647,14,6,"BACKEND_URL"],[1,649,14,17],[1,692,37,6,"AuthContext"],[1,695,37,20],[1,697,37,20,"createContext"],[1,699,37,33,"createContext"],[1,714,37,51],[1,715,38,2,"user"],[1,720,38,8],[1,725,39,2,"loading"],[1,734,39,11],[1,736,40,2,"login"],[1,742,40,9,"async"],[1,754,41,2,"logout"],[1,761,41,10,"async"],[1,773,42,2,"refreshUser"],[1,785,42,15,"async"],[1,799,45,13,"useAuth"],[1,801,45,23,"useAuth"],[1,806,45,29],[1,808,45,29,"useContext"],[1,810,45,39,"useContext"],[1,822,45,40,"AuthContext"],[1,825,47,13,"AuthProvider"],[1,827,47,69,"AuthProvider"],[1,829,47,72,"children"],[1,844,48,2],[1,850,48,9,"user"],[1,852,48,15,"setUser"],[1,856,48,26],[1,858,48,26,"useState"],[1,860,48,34,"useState"],[1,870,48,48],[1,877,49,9,"loading"],[1,879,49,18,"setLoading"],[1,883,49,32],[1,885,49,32,"useState"],[1,887,49,40,"useState"],[1,898,49,41],[1,902,52,2],[1,904,52,2,"useEffect"],[1,906,52,11,"useEffect"],[1,917,52,12],[1,922,53,4,"checkExistingSession"],[1,927,54,5],[1,932,57,2],[1,934,57,2,"useEffect"],[1,936,57,11,"useEffect"],[1,947,57,12],[1,952,58,8,"user"],[1,955,62,5],[1,956,62,6,"user"],[1,961,65,2],[1,963,65,2,"useEffect"],[1,965,65,11,"useEffect"],[1,976,65,12],[1,981,66,4],[1,985,66,9,"user"],[1,987,66,15],[1,994,68,4],[1,998,68,8,"isActive"],[1,1001,68,19],[1,1003,69,8,"timeoutId"],[1,1005,69,43],[1,1010,70,8,"intervalId"],[1,1012,70,44],[1,1017,72,4],[1,1023,72,10,"sendHeartbeat"],[1,1025,72,26,"sendHeartbeat"],[1,1030,73,11,"isActive"],[1,1033,75,6,"AsyncStorage"],[1,1035,75,18,"default"],[1,1043,75,19,"getItem"],[1,1051,75,27],[1,1068,75,44,"then"],[1,1073,75,49,"token"],[1,1077,76,12,"token"],[1,1080,76,21,"isActive"],[1,1083,77,10,"axios"],[1,1085,77,15,"default"],[1,1093,77,16,"post"],[1,1098,77,21],[1,1101,77,24,"BACKEND_URL"],[1,1124,77,58],[1,1125,77,59],[1,1127,77,62],[1,1128,78,12,"headers"],[1,1136,78,21],[1,1137,78,23,"Authorization"],[1,1151,78,38],[1,1161,78,48,"token"],[1,1166,79,12,"timeout"],[1,1174,79,21],[1,1180,80,13,"catch"],[1,1186,80,19],[1,1196,82,9,"catch"],[1,1202,82,15],[1,1211,91,4],[1,1218,86,4,"timeoutId"],[1,1220,86,16,"setTimeout"],[1,1231,86,27,"sendHeartbeat"],[1,1233,86,42],[1,1238,89,4,"intervalId"],[1,1240,89,17,"setInterval"],[1,1252,89,29,"sendHeartbeat"],[1,1254,89,44],[1,1260,91,11],[1,1265,92,6,"isActive"],[1,1268,92,17],[1,1270,93,10,"timeoutId"],[1,1273,93,21,"clearTimeout"],[1,1286,93,34,"timeoutId"],[1,1289,94,10,"intervalId"],[1,1292,94,22,"clearInterval"],[1,1306,94,36,"intervalId"],[1,1311,96,5],[1,1312,96,6,"user"],[1,1316,98,2],[1,1322,139,8,"checkExistingSession"],[1,1324,139,31,"async"],[1,1334,140,4],[1,1338,141,6],[1,1344,141,12,"token"],[1,1352,141,26,"AsyncStorage"],[1,1354,141,38,"default"],[1,1362,141,39,"getItem"],[1,1370,141,47],[1,1387,142,6],[1,1390,142,10,"token"],[1,1392,142,17],[1,1393,144,8],[1,1399,144,14,"response"],[1,1407,144,31,"axios"],[1,1409,144,36,"default"],[1,1417,144,37,"get"],[1,1421,144,41],[1,1424,144,44,"BACKEND_URL"],[1,1440,144,71],[1,1441,145,10,"headers"],[1,1449,145,19],[1,1450,145,21,"Authorization"],[1,1464,145,36],[1,1474,145,46,"token"],[1,1481,147,8,"setUser"],[1,1483,147,16,"response"],[1,1485,147,25,"data"],[1,1490,148,6],[1,1491,149,4],[1,1492,149,6],[1,1498,149,13,"error"],[1,1501,150,6,"console"],[1,1509,150,14,"error"],[1,1515,150,20],[1,1538,150,44,"error"],[1,1547,151,12,"AsyncStorage"],[1,1549,151,24,"default"],[1,1557,151,25,"removeItem"],[1,1568,151,36],[1,1584,152,4],[1,1585,152,5],[1,1593,153,6,"setLoading"],[1,1596,153,17],[1,1598,154,4],[1,1601,184,8,"handleAuthRedirect"],[1,1603,184,29,"async"],[1,1613,185,4],[1,1617,187,6],[1,1621,187,10,"sessionId"],[1,1623,187,22],[1,1628,198,6],[1,1631,190,10,"url"],[1,1633,190,14,"includes"],[1,1642,190,23],[1,1658,191,8,"sessionId"],[1,1660,191,20,"url"],[1,1662,191,24,"split"],[1,1668,191,30],[1,1684,191,46],[1,1687,191,49,"split"],[1,1693,191,55],[1,1698,191,60],[1,1701,194,15,"url"],[1,1703,194,19,"includes"],[1,1712,194,28],[1,1730,195,8,"sessionId"],[1,1732,195,20,"url"],[1,1734,195,24,"split"],[1,1740,195,30],[1,1756,195,46],[1,1759,195,49,"split"],[1,1765,195,55],[1,1770,195,60],[1,1775,198,11,"sessionId"],[1,1777,199,8],[1,1783,199,14],[1,1787,199,18,"Error"],[1,1793,199,24],[1,1832,203,6],[1,1838,203,12,"response"],[1,1846,203,29,"axios"],[1,1848,203,34,"default"],[1,1856,203,35,"post"],[1,1861,204,8],[1,1864,204,11,"BACKEND_URL"],[1,1885,205,8],[1,1886,205,9],[1,1888,206,8],[1,1889,207,10,"headers"],[1,1897,207,19],[1,1898,207,21],[1,1913,207,37,"sessionId"],[1,1919,211,12,"session_token"],[1,1933,211,14,"session_token"],[1,1938,211,32,"userData"],[1,1941,211,45,"response"],[1,1943,211,54,"data"],[1,1954,214,12,"AsyncStorage"],[1,1956,214,24,"default"],[1,1964,214,25,"setItem"],[1,1972,214,33],[1,1988,214,50,"session_token"],[1,1991,217,6],[1,1997,217,12,"userResponse"],[1,2005,217,33,"axios"],[1,2007,217,38,"default"],[1,2015,217,39,"get"],[1,2019,217,43],[1,2022,217,46,"BACKEND_URL"],[1,2038,217,73],[1,2039,218,8,"headers"],[1,2047,218,17],[1,2048,218,19,"Authorization"],[1,2062,218,34],[1,2072,218,44,"session_token"],[1,2079,221,6,"setUser"],[1,2081,221,14,"userResponse"],[1,2083,221,27,"data"],[1,2088,222,4],[1,2089,222,6],[1,2095,222,13,"error"],[1,2098,224,6],[1,2104,223,6,"console"],[1,2112,223,14,"error"],[1,2118,223,20],[1,2141,223,44,"error"],[1,2144,224,12,"error"],[1,2145,225,4],[1,2148,301,2],[1,2155,286,2],[1,2157,286,2,"useEffect"],[1,2159,286,11,"useEffect"],[1,2170,286,12],[1,2175,288,28,"async"],[1,2186,289,21,"window"],[1,2193,289,28,"location"],[1,2202,289,37,"hash"],[1,2207,290,17,"includes"],[1,2216,290,26],[1,2239,291,16,"handleAuthRedirect"],[1,2241,291,35,"window"],[1,2248,291,42,"location"],[1,2257,291,51,"href"],[1,2263,293,10,"window"],[1,2270,293,17,"history"],[1,2278,293,25,"replaceState"],[1,2291,293,38],[1,2292,293,39],[1,2294,293,42,"document"],[1,2303,293,51,"title"],[1,2309,293,58,"window"],[1,2316,293,65,"location"],[1,2325,293,74,"pathname"],[1,2337,297,6,"handleWebAuth"],[1,2341,299,5],[1,2346,302,4],[1,2348,302,4,"_reactJsxRuntime"],[1,2350,302,4,"jsx"],[1,2355,302,5,"AuthContext"],[1,2357,302,17,"Provider"],[1,2366,302,25],[1,2367,302,26,"value"],[1,2373,302,33],[1,2374,302,35,"user"],[1,2381,302,41,"loading"],[1,2391,302,50,"login"],[1,2397,157,16,"async"],[1,2407,158,4],[1,2411,159,6,"setLoading"],[1,2414,159,17],[1,2417,161,6],[1,2423,161,12,"redirectUrl"],[1,2425,162,29],[1,2445,162,18,"window"],[1,2452,162,43,"window"],[1,2459,162,50,"location"],[1,2468,162,59,"origin"],[1,2475,162,68],[1,2479,162,74],[1,2482,162,77,"BACKEND_URL"],[1,2487,165,12,"authUrl"],[1,2489,165,22],[1,2533,165,66,"encodeURIComponent"],[1,2552,165,85,"redirectUrl"],[1,2557,169,8,"window"],[1,2564,169,15,"location"],[1,2573,169,24,"href"],[1,2578,169,31,"authUrl"],[1,2579,178,4],[1,2580,178,6],[1,2586,178,13,"error"],[1,2589,179,6,"console"],[1,2597,179,14,"error"],[1,2603,179,20],[1,2618,179,36,"error"],[1,2621,180,6,"setLoading"],[1,2624,180,17],[1,2626,181,4],[1,2629,302,57,"logout"],[1,2636,228,17,"async"],[1,2646,230,4],[1,2649,230,51],[1,2669,230,40,"window"],[1,2676,230,64],[1,2677,232,6],[1,2681,233,8,"localStorage"],[1,2694,233,21,"removeItem"],[1,2705,233,32],[1,2721,234,6],[1,2722,234,8],[1,2728,234,15,"e"],[1,2731,234,19],[1,2732,237,6],[1,2738,237,12,"token"],[1,2740,237,20,"localStorage"],[1,2753,237,33,"getItem"],[1,2761,237,41],[1,2778,247,6],[1,2785,238,10,"token"],[1,2788,239,8,"fetch"],[1,2794,239,14],[1,2797,239,17,"BACKEND_URL"],[1,2817,239,48],[1,2818,240,10,"method"],[1,2825,240,18],[1,2832,241,10,"headers"],[1,2840,241,19],[1,2841,241,21,"Authorization"],[1,2855,241,36],[1,2865,241,46,"token"],[1,2872,242,11,"catch"],[1,2878,242,17],[1,2891,246,6,"window"],[1,2898,246,13,"location"],[1,2907,246,22,"href"],[1,2912,246,29],[1,2921,248,4],[1,2922,251,4],[1,2926,252,6],[1,2932,252,12,"token"],[1,2940,252,26,"AsyncStorage"],[1,2942,252,38,"default"],[1,2950,252,39,"getItem"],[1,2958,252,47],[1,2975,253,10,"token"],[1,2978,254,8,"axios"],[1,2980,254,13,"default"],[1,2988,254,14,"post"],[1,2993,254,19],[1,2996,254,22,"BACKEND_URL"],[1,3016,254,53],[1,3017,254,54],[1,3019,254,57],[1,3020,255,10,"headers"],[1,3028,255,19],[1,3029,255,21,"Authorization"],[1,3043,255,36],[1,3053,255,46,"token"],[1,3060,256,11,"catch"],[1,3066,256,17],[1,3073,258,4],[1,3074,258,6],[1,3080,258,13,"error"],[1,3083,259,6,"console"],[1,3091,259,14,"error"],[1,3097,259,20],[1,3113,259,37,"error"],[1,3115,260,4],[1,3122,262,10,"AsyncStorage"],[1,3124,262,22,"default"],[1,3132,262,23,"removeItem"],[1,3143,262,34],[1,3160,263,4,"setUser"],[1,3162,263,12],[1,3169,302,65,"refreshUser"],[1,3181,266,22,"async"],[1,3191,267,4],[1,3195,268,6],[1,3201,268,12,"token"],[1,3209,268,26,"AsyncStorage"],[1,3211,268,38,"default"],[1,3219,268,39,"getItem"],[1,3227,268,47],[1,3244,269,6],[1,3247,269,10,"token"],[1,3249,269,17],[1,3250,271,8],[1,3256,271,14,"response"],[1,3264,271,31,"axios"],[1,3266,271,36,"default"],[1,3274,271,37,"get"],[1,3278,271,41],[1,3281,271,44,"BACKEND_URL"],[1,3301,271,74,"Date"],[1,3306,271,79,"now"],[1,3314,271,88],[1,3315,272,10,"headers"],[1,3323,272,19],[1,3324,273,12,"Authorization"],[1,3338,273,27],[1,3348,273,37,"token"],[1,3352,274,12],[1,3368,274,29],[1,3379,275,12,"Pragma"],[1,3386,275,22],[1,3400,278,8,"setUser"],[1,3402,278,16,"response"],[1,3404,278,25,"data"],[1,3409,279,6],[1,3410,280,4],[1,3411,280,6],[1,3417,280,13,"error"],[1,3420,281,6,"console"],[1,3428,281,14,"error"],[1,3434,281,20],[1,3456,281,43,"error"],[1,3458,282,4],[1,3462,302,79,"children"],[1,3471,303,7,"children"],[1,3475,306,2],[1,3478]],"functionMap":{"names":["<global>","createContext$argument_0.login","createContext$argument_0.logout","createContext$argument_0.refreshUser","useAuth","AuthProvider","useEffect$argument_0","sendHeartbeat","AsyncStorage.getItem.then$argument_0","axios.post._catch$argument_0","AsyncStorage.getItem.then._catch$argument_0","<anonymous>","setupPushNotifications","addNotificationReceivedListener$argument_0","addNotificationResponseReceivedListener$argument_0","checkExistingSession","login","handleAuthRedirect","logout","fetch._catch$argument_0","refreshUser","handleWebAuth"],"mappings":"AAA;SCuC,cD;UEC,cF;eGC,cH;uBIG,6BJ;qEKE;YCK;GDE;YCG;GDK;YCG;0BCO;iDCG;mBCK,QD;ODE,QG,QH;KDC;WKQ;KLI;GDC;iCOE;mECkB;ODE;uEEE;OFQ;aDE;OCG;GPI;+BUE;GVgB;gBWE;GXyB;6BYE;GZ0C;iBaE;iBCc,QD;iBTc,QS;GbQ;sBeE;GfiB;YCG;4BeE;OfO;GDI;CLO"},"hasCjsExports":false},"type":"js/module"}]}